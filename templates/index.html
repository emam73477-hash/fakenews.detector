<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YUVAi - AI Truth Detector</title>
    <!-- Tailwind & Fonts -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&family=Inter:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; transition: all 0.3s ease; scroll-behavior: smooth; }
        body.rtl { font-family: 'Cairo', sans-serif; direction: rtl; }
        
        /* وسيط 1: فيديو الخلفية */
        #bg-video {
            position: fixed; top: 0; left: 0; min-width: 100%; min-height: 100%;
            z-index: -1; opacity: 0.15; object-fit: cover;
        }

        .glass { background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.1); }
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #2563eb; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; display: none; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .result-fade { animation: fadeInUp 0.6s ease-out; }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="bg-slate-950 text-white min-h-screen">

    <!-- وسيط 1: فيديو الخلفية التكنولوجي -->
    <video autoplay muted loop id="bg-video">
        <source src="https://www.pexels.com/download/video/2235282/" type="video/mp4">
    </video>

    <!-- Navbar -->
    <nav class="glass p-4 shadow-2xl flex justify-between items-center sticky top-0 z-50 border-b border-white/5">
        <div class="flex items-center gap-4">
            <!-- وسيط 10: أيقونة الدرع -->
            <i class="fas fa-shield-halved text-3xl text-blue-500"></i>
            <h1 class="text-2xl font-black tracking-tighter text-blue-400">YUVAi</h1>
        </div>
        
        <div class="flex items-center gap-6">
            <div class="hidden md:flex items-center gap-3">
                <div class="text-right">
                    <p id="lbl_logged_in" class="text-[10px] text-gray-500 uppercase tracking-widest">System Active</p>
                    <p class="text-sm font-bold text-white">{{ user }}</p>
                </div>
                <!-- وسيط 3: صورة الأفاتار -->
                <img src="https://images.pexels.com/photos/8386366/pexels-photo-8386366.jpeg" class="w-10 h-10 rounded-full border-2 border-blue-600 object-cover shadow-lg shadow-blue-500/20">
            </div>
            <a href="/logout" class="bg-red-600/20 hover:bg-red-600 text-red-500 hover:text-white p-2 px-4 rounded-lg text-xs font-bold transition flex items-center gap-2 border border-red-600/30">
                <span id="lbl_logout">Logout</span> <i class="fas fa-power-off"></i>
            </a>
        </div>
    </nav>

    <div class="container mx-auto px-4 py-12">
        
        <!-- MAIN TOOL CARD -->
        <div class="max-w-4xl mx-auto glass p-8 md:p-12 rounded-[2rem] shadow-inner relative mb-20 overflow-hidden">
            <!-- Glow Effect -->
            <div class="absolute top-0 right-0 -mt-10 -mr-10 w-40 h-40 bg-blue-500 rounded-full opacity-10 blur-[80px]"></div>

            <h2 id="lbl_title" class="text-4xl font-black text-center mb-2">Check Authenticity</h2>
            <p id="lbl_subtitle" class="text-center text-gray-400 mb-10 text-sm tracking-wide">Neural network analysis for modern information verification.</p>

            <div class="relative group">
                <textarea id="newsText" rows="3" oninput="detectInputLang(this)" placeholder="Paste news text here / ضع الخبر هنا..." 
                    class="w-full p-6 bg-black/40 border border-white/10 rounded-2xl focus:outline-none focus:border-blue-500 text-xl transition shadow-2xl placeholder:text-gray-600"></textarea>
                
                <button onclick="checkNews()" id="verifyBtn" 
                    class="absolute bottom-4 right-4 bg-blue-600 hover:bg-blue-400 text-white px-8 py-3 rounded-xl font-black transition flex items-center gap-3 shadow-xl hover:shadow-blue-500/40">
                    <span id="lbl_btn">Verify</span> 
                    <!-- وسيط 11: أيقونة البحث -->
                    <i class="fas fa-magnifying-glass"></i>
                </button>
            </div>

            <!-- LOADER -->
            <div class="flex justify-center mt-6">
                <div id="loading" class="loader"></div>
            </div>
            
            <!-- RESULT CARD -->
            <div id="resultCard" class="hidden mt-10 p-8 bg-slate-900/80 rounded-3xl border border-blue-500/30 result-fade relative">
                
                <button onclick="document.getElementById('resultCard').classList.add('hidden')" class="absolute top-4 right-4 text-gray-500 hover:text-white">
                    <i class="fas fa-times"></i>
                </button>

                <div class="flex flex-col md:flex-row justify-between items-center gap-8 mb-8">
                    <div class="flex items-center gap-6">
                        <!-- وسائط الأيقونات الديناميكية 12, 13, 14 -->
                        <div id="resIconContainer" class="text-6xl drop-shadow-[0_0_15px_rgba(59,130,246,0.5)]"></div>
                        <div>
                            <h3 id="lbl_result_header" class="text-gray-500 text-[10px] uppercase font-bold tracking-[0.2em]">AI Neural Analysis</h3>
                            <h2 id="verdictTitle" class="text-4xl font-black tracking-tight"></h2>
                            
                            <div id="dateSection" class="mt-2">
                                <span id="dateText" class="inline-flex items-center gap-2 px-3 py-1 rounded-full text-[10px] font-bold uppercase bg-blue-900/40 text-blue-300 border border-blue-700/50">
                                    <i class="fas fa-calendar-day"></i> <span id="actualDate"></span>
                                </span>
                            </div>
                        </div>
                    </div>
                    <div id="scoreBadge" class="text-3xl font-black p-6 rounded-2xl bg-white/5 border border-white/10 shadow-2xl"></div>
                </div>

                <!-- Score Bar -->
                <div class="w-full bg-black/60 rounded-full h-3 mb-8 overflow-hidden p-0.5 border border-white/5">
                    <div id="scoreBar" class="h-full rounded-full transition-all duration-1000 shadow-[0_0_10px]" style="width: 0%"></div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Key Indicators -->
                    <div class="bg-black/30 p-6 rounded-2xl border border-white/5">
                        <h4 id="lbl_reasons" class="text-gray-500 text-[10px] font-bold uppercase mb-4 tracking-widest">Key Indicators</h4>
                        <ul id="reasonsList" class="space-y-3 text-sm text-gray-300"></ul>
                    </div>
                    <!-- Sources -->
                    <div id="sourcesContainer" class="hidden bg-black/30 p-6 rounded-2xl border border-white/5">
                        <h4 id="lbl_sources" class="text-gray-500 text-[10px] font-bold uppercase mb-4 tracking-widest">Verified Sources</h4>
                        <div id="sourcesList" class="grid gap-2"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- وسيط 2: فيديو الذراع الروبوتية التعليمي -->
        <div class="max-w-4xl mx-auto mb-32">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
                <div class="order-2 md:order-1">
                    <h3 class="text-3xl font-black mb-4">How AI Detects Truth</h3>
                    <p class="text-gray-400 leading-relaxed text-sm md:text-base">Our system uses temporal cross-referencing and semantic analysis to ensure news reported "yesterday" isn't confused with outdated records. We verify metadata, source credibility, and negation patterns in real-time.</p>
                </div>
                <div class="order-1 md:order-2 rounded-[2rem] overflow-hidden border border-white/10 shadow-2xl group">
                    <video controls class="w-full transition duration-500 group-hover:scale-105">
                        <source src="https://www.pexels.com/download/video/7744339/" type="video/mp4">
                    </video>
                </div>
            </div>
        </div>

        <!-- وسائط 5, 6, 7: صور النصائح -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-32">
            <div class="glass p-6 rounded-[2rem] text-center hover:border-blue-500/50 transition duration-500 group">
                <img src="https://images.pexels.com/photos/27988902/pexels-photo-27988902.jpeg" class="w-full h-48 object-cover rounded-2xl mb-6 shadow-xl group-hover:scale-105 transition">
                <h4 class="font-bold uppercase text-xs tracking-widest text-blue-400">Verify Source</h4>
            </div>
            <div class="glass p-6 rounded-[2rem] text-center hover:border-blue-500/50 transition duration-500 group">
                <img src="https://images.pexels.com/photos/1050558/pexels-photo-1050558.jpeg" class="w-full h-48 object-cover rounded-2xl mb-6 shadow-xl group-hover:scale-105 transition">
                <h4 class="font-bold uppercase text-xs tracking-widest text-blue-400">Cross-Check Dates</h4>
            </div>
            <div class="glass p-6 rounded-[2rem] text-center hover:border-blue-500/50 transition duration-500 group">
                <img src="https://images.pexels.com/photos/4900910/pexels-photo-4900910.png" class="w-full h-48 object-cover rounded-2xl mb-6 shadow-xl group-hover:scale-105 transition">
                <h4 class="font-bold uppercase text-xs tracking-widest text-blue-400">Neural Logic</h4>
            </div>
        </div>

        <!-- RECENT FEED -->
        <div class="flex items-center justify-between mb-8 max-w-4xl mx-auto">
            <h3 class="text-xl font-bold flex items-center gap-3">
                <i class="fas fa-history text-blue-500"></i> <span id="lbl_recent">Recent Verifications</span>
            </h3>
        </div>
        
        <div class="max-w-4xl mx-auto">
            {% if news|length == 0 %}
            <div class="text-center py-20 glass rounded-[2rem] border-dashed border-2 border-white/5 group">
                <!-- وسيط 8: صورة الحالة الفارغة -->
                <img src="https://images.pexels.com/photos/32452878/pexels-photo-32452878.jpeg" class="w-48 mx-auto rounded-full h-48 object-cover mb-8 border-4 border-blue-500/20 grayscale group-hover:grayscale-0 transition duration-700">
                <p class="text-gray-500 font-medium italic">The database is clean. Start your first neural scan above.</p>
            </div>
            {% else %}
            <!-- السجل (اختياري: يمكن إضافة قائمة هنا) -->
            <div class="text-center text-gray-500 italic">Historical data is securely archived in the system core.</div>
            {% endif %}
        </div>

        <!-- وسيط 9: صورة الترابط العالمي -->
        <div class="mt-40 text-center">
            <p class="text-[10px] text-gray-500 uppercase tracking-[0.5em] mb-8">Global Verification Network</p>
            <img src="https://images.pexels.com/photos/13719799/pexels-photo-13719799.jpeg" class="w-full max-w-4xl mx-auto rounded-[3rem] opacity-20 grayscale hover:grayscale-0 transition duration-1000 border border-white/10">
        </div>

    </div>

    <!-- وسائط 19, 20: المؤثرات الصوتية -->
    <audio id="snd_real" src="https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3"></audio>
    <audio id="snd_fake" src="https://assets.mixkit.co/active_storage/sfx/951/951-preview.mp3"></audio>

    <!-- Footer -->
    <footer class="mt-40 p-20 bg-black border-t border-white/5 text-center relative overflow-hidden">
        <!-- وسيط 4: فن رقمي في الفوتر -->
        <img src="https://images.pexels.com/photos/30547569/pexels-photo-30547569.jpeg" class="absolute top-0 left-0 w-full h-full object-cover opacity-5">
        
        <div class="relative z-10">
            <div class="flex justify-center gap-8 mb-10 text-2xl text-gray-600">
                <i class="fab fa-facebook hover:text-blue-500 cursor-pointer transition"></i>
                <i class="fab fa-twitter hover:text-blue-400 cursor-pointer transition"></i>
                <i class="fab fa-github hover:text-white cursor-pointer transition"></i>
            </div>
            <p class="text-gray-600 font-bold tracking-widest text-[10px] uppercase">© 2025 YUVAi System | Artificial Intelligence Division</p>
        </div>
    </footer>

    <script>
        // قاموس الترجمة المدمج
        const strings = {
            en: {
                title: "Check Authenticity",
                subtitle: "Neural network analysis for modern information verification.",
                btn: "Verify",
                analyzing: "Analyzing...",
                resultHeader: "AI Neural Analysis",
                reasons: "Key Indicators",
                sources: "Verified Sources",
                recent: "Recent Verifications",
                logout: "Logout",
                loggedIn: "System Active",
                real_label: "REAL NEWS",
                fake_label: "FAKE NEWS"
            },
            ar: {
                title: "تحقق من المصداقية",
                subtitle: "تحليل الشبكات العصبية للتحقق من المعلومات الحديثة.",
                btn: "تحقق الآن",
                analyzing: "جاري التحليل...",
                resultHeader: "تحليل الذكاء الاصطناعي",
                reasons: "المؤشرات الرئيسية",
                sources: "المصادر الموثوقة",
                recent: "عمليات التحقق الأخيرة",
                logout: "خروج",
                loggedIn: "النظام نشط",
                real_label: "خبر حقيقي",
                fake_label: "خبر زائف"
            }
        };

        let currentLang = 'en';

        // 1. كشف اللغة تلقائياً عند الكتابة
        function detectInputLang(textarea) {
            const text = textarea.value;
            const isArabic = /[\u0600-\u06FF]/.test(text);
            
            if (isArabic && currentLang !== 'ar') {
                setLanguage('ar');
            } else if (!isArabic && text.length > 0 && currentLang !== 'en') {
                setLanguage('en');
            }
        }

        // 2. تبديل لغة الواجهة
        function setLanguage(lang) {
            currentLang = lang;
            const body = document.body;
            const t = strings[lang];

            if (lang === 'ar') {
                body.classList.add('rtl');
                document.getElementById('verifyBtn').classList.replace('right-4', 'left-4');
            } else {
                body.classList.remove('rtl');
                document.getElementById('verifyBtn').classList.replace('left-4', 'right-4');
            }

            // تحديث النصوص
            document.getElementById('lbl_title').innerText = t.title;
            document.getElementById('lbl_subtitle').innerText = t.subtitle;
            document.getElementById('lbl_btn').innerText = t.btn;
            document.getElementById('lbl_result_header').innerText = t.resultHeader;
            document.getElementById('lbl_reasons').innerText = t.reasons;
            document.getElementById('lbl_sources').innerText = t.sources;
            document.getElementById('lbl_recent').innerText = t.recent;
            document.getElementById('lbl_logout').innerText = t.logout;
            document.getElementById('lbl_logged_in').innerText = t.loggedIn;
        }

        // 3. منطق التحقق الأساسي
        async function checkNews() {
            const text = document.getElementById('newsText').value.trim();
            const btn = document.getElementById('verifyBtn');
            const loader = document.getElementById('loading');
            const resultCard = document.getElementById('resultCard');
            
            if(!text) return;

            resultCard.classList.add('hidden');
            loader.style.display = "block";
            btn.disabled = true;
            btn.innerHTML = `<i class="fas fa-spinner fa-spin"></i> ${strings[currentLang].analyzing}`;
            
            try {
                const response = await fetch('/analyze', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ text: text, lang: currentLang }) 
                });

                const data = await response.json();
                
                loader.style.display = "none";
                resultCard.classList.remove('hidden');
                btn.disabled = false;
                btn.innerHTML = `${strings[currentLang].btn} <i class="fas fa-magnifying-glass"></i>`;

                // تحديث النتيجة والألوان
                const title = document.getElementById('verdictTitle');
                const badge = document.getElementById('scoreBadge');
                const iconContainer = document.getElementById('resIconContainer');
                
                title.innerText = data.verdict;
                badge.innerText = currentLang === 'ar' ? `%${data.score}` : `${data.score}%`;

                let colorClass = "text-yellow-500";
                let barClass = "bg-yellow-500 shadow-yellow-500/50";
                let icon = '<i class="fas fa-exclamation-triangle text-yellow-500"></i>';

                if (data.score >= 80) {
                    document.getElementById('snd_real').play(); // وسيط 19
                    colorClass = "text-green-500";
                    barClass = "bg-green-500 shadow-green-500/50";
                    icon = '<i class="fas fa-check-circle text-green-500"></i>'; // وسيط 12
                } else if(data.score <= 35) {
                    document.getElementById('snd_fake').play(); // وسيط 20
                    colorClass = "text-red-500";
                    barClass = "bg-red-500 shadow-red-500/50";
                    icon = '<i class="fas fa-times-circle text-red-500"></i>'; // وسيط 13
                }

                title.className = `text-4xl font-black tracking-tight ${colorClass}`;
                iconContainer.innerHTML = icon;
                document.getElementById('scoreBar').className = `h-full rounded-full transition-all duration-1000 ${barClass}`;
                setTimeout(() => document.getElementById('scoreBar').style.width = data.score + "%", 100);

                // التاريخ
                document.getElementById('actualDate').innerText = data.date_info;

                // المؤشرات (Reasons)
                const list = document.getElementById('reasonsList');
                list.innerHTML = "";
                data.reasons.forEach(r => {
                    list.innerHTML += `<li class="flex gap-3 items-start"><i class="fas fa-shield-check mt-1 text-blue-500 text-xs"></i> <span>${r}</span></li>`;
                });

                // المصادر (Sources)
                const sList = document.getElementById('sourcesList');
                const sCont = document.getElementById('sourcesContainer');
                sList.innerHTML = "";
                
                if (data.sources && data.sources.length > 0) {
                    sCont.classList.remove('hidden');
                    data.sources.forEach(s => {
                        let domain = new URL(s.link).hostname.replace('www.','');
                        sList.innerHTML += `
                            <a href="${s.link}" target="_blank" class="block bg-black/40 p-3 rounded-xl border border-white/5 hover:border-blue-500/50 transition flex justify-between items-center group">
                                <div class="text-left">
                                    <div class="text-[8px] font-bold text-blue-500 uppercase">${domain}</div>
                                    <div class="text-[11px] text-gray-400 group-hover:text-white truncate w-48">${s.title}</div>
                                </div>
                                <i class="fas fa-external-link-alt text-[10px] text-gray-700 group-hover:text-blue-500"></i>
                            </a>`;
                    });
                } else { sCont.classList.add('hidden'); }

            } catch(e) {
                console.error(e);
                loader.style.display = "none";
                alert("Neural Link Failure");
            }
        }
    </script>
</body>
</html>



