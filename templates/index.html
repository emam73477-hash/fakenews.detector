<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YUVAi - AI Truth Detector</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&family=Inter:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; transition: all 0.3s ease; background-color: #0f172a; color: white; }
        body.rtl { font-family: 'Cairo', sans-serif; direction: rtl; }

        /* الخلفية والفيديو */
        #bg-video { position: fixed; top:0; left:0; min-width:100%; min-height:100%; z-index:-1; opacity:0.15; object-fit:cover; }

        .glass { background: rgba(30, 41, 59, 0.7); backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1); }
        .fade-in { animation: fadeInUp 0.5s ease-out; }
        @keyframes fadeInUp { from { opacity:0; transform: translateY(20px);} to {opacity:1; transform:translateY(0);} }

        /* Loader */
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #2563eb; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; display: none; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="min-h-screen">

    <!-- فيديو الخلفية -->
    <video autoplay muted loop id="bg-video">
        <source src="https://www.pexels.com/download/video/2235282/" type="video/mp4">
    </video>

    <!-- Navbar -->
    <nav class="glass p-4 shadow-2xl flex justify-between items-center sticky top-0 z-50">
        <div class="flex items-center gap-4">
            <i class="fas fa-shield-halved text-3xl text-blue-500"></i>
            <h1 class="text-2xl font-black tracking-tighter text-blue-400">YUVAi</h1>
        </div>
        <div class="flex items-center gap-6">
            <div class="hidden md:flex items-center gap-3">
                <div class="text-right">
                    <p id="lbl_logged_in" class="text-[10px] text-gray-500 uppercase">System Active</p>
                    <p class="text-sm font-bold">{{ user }}</p>
                </div>
                <img src="https://images.pexels.com/photos/8386366/pexels-photo-8386366.jpeg" class="w-10 h-10 rounded-full border-2 border-blue-600 object-cover">
            </div>
            <a href="/logout" class="bg-red-600/20 hover:bg-red-600 text-red-500 hover:text-white p-2 px-4 rounded-lg text-xs font-bold transition flex items-center gap-2 border border-red-600/30">
                <span id="lbl_logout">Logout</span> <i class="fas fa-power-off"></i>
            </a>
        </div>
    </nav>

    <div class="container mx-auto px-4 py-12">

        <!-- Search / Verification -->
        <div class="max-w-4xl mx-auto glass p-10 rounded-3xl shadow-inner relative mb-20">
            <h2 id="lbl_title" class="text-4xl font-black text-center mb-2">Check Authenticity</h2>
            <p id="lbl_subtitle" class="text-center text-gray-400 mb-10 text-sm">Neural network analysis for modern information.</p>

            <div class="relative">
                <textarea id="newsText" rows="3" oninput="detectLang(this)" placeholder="Paste news text here..." 
                    class="w-full p-6 bg-black/40 border border-white/10 rounded-2xl focus:outline-none focus:border-blue-500 text-xl transition shadow-2xl"></textarea>
                
                <button onclick="checkNews()" id="verifyBtn" 
                    class="absolute bottom-4 right-4 bg-blue-600 hover:bg-blue-400 text-white px-8 py-3 rounded-xl font-black transition flex items-center gap-3 shadow-xl">
                    <span id="lbl_btn">Verify</span> 
                    <i class="fas fa-magnifying-glass"></i>
                </button>
            </div>

            <!-- Loader -->
            <div class="flex justify-center mt-6">
                <div id="loading" class="loader"></div>
            </div>

            <!-- Result Display -->
            <div id="resultCard" class="hidden mt-10 p-8 bg-blue-600/10 rounded-2xl border border-blue-500/30 fade-in">
                <div class="flex flex-col md:flex-row justify-between items-center gap-8">
                    <div class="flex items-center gap-6">
                        <div id="resIconContainer" class="text-6xl"></div>
                        <div>
                            <h2 id="verdictTitle" class="text-4xl font-black"></h2>
                            <p id="dateText" class="text-blue-400 font-bold mt-2 flex items-center gap-2">
                                <i class="fas fa-calendar-day"></i> <span id="actualDate"></span>
                            </p>
                        </div>
                    </div>
                    <div id="scoreBadge" class="text-3xl font-black p-6 rounded-2xl bg-white/5 border border-white/10"></div>
                </div>
                <div class="w-full bg-black/40 rounded-full h-3 mt-8 overflow-hidden p-0.5">
                    <div id="scoreBar" class="h-full rounded-full transition-all duration-1000 bg-blue-500" style="width:0%"></div>
                </div>
            </div>
        </div>

        <!-- Video Section -->
        <div class="max-w-4xl mx-auto mb-32">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-10 items-center">
                <div>
                    <h3 class="text-3xl font-black mb-4">How AI Detects Truth</h3>
                    <p class="text-gray-400 leading-relaxed">Our system uses temporal cross-referencing to ensure news reported "yesterday" isn't confused with outdated records from months ago.</p>
                </div>
                <div class="rounded-3xl overflow-hidden border border-white/10 shadow-2xl">
                    <video controls class="w-full">
                        <source src="https://www.pexels.com/download/video/7744339/" type="video/mp4">
                    </video>
                </div>
            </div>
        </div>

        <!-- Tips Section -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-32">
            <div class="glass p-6 rounded-3xl text-center">
                <img src="https://images.pexels.com/photos/27988902/pexels-photo-27988902.jpeg" class="w-full h-48 object-cover rounded-2xl mb-4">
                <h4 class="font-bold">Verify Source</h4>
            </div>
            <div class="glass p-6 rounded-3xl text-center">
                <img src="https://images.pexels.com/photos/1050558/pexels-photo-1050558.jpeg" class="w-full h-48 object-cover rounded-2xl mb-4">
                <h4 class="font-bold">Cross-Check Dates</h4>
            </div>
            <div class="glass p-6 rounded-3xl text-center">
                <img src="https://images.pexels.com/photos/4900910/pexels-photo-4900910.png" class="w-full h-48 object-cover rounded-2xl mb-4">
                <h4 class="font-bold">Neural Logic</h4>
            </div>
        </div>

        <!-- Placeholder if no news -->
        {% if news|length == 0 %}
        <div class="text-center opacity-40">
            <img src="https://images.pexels.com/photos/32452878/pexels-photo-32452878.jpeg" class="w-64 mx-auto rounded-full h-64 object-cover mb-6 border-4 border-blue-500/20">
            <p>Waiting for the first verification scan...</p>
        </div>
        {% endif %}

    </div>

    <!-- Audio -->
    <audio id="snd_real" src="https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3"></audio>
    <audio id="snd_fake" src="https://assets.mixkit.co/active_storage/sfx/951/951-preview.mp3"></audio>

    <script>
        const strings = {
            en: { title: "Check Authenticity", btn: "Verify" },
            ar: { title: "تحقق من المصداقية", btn: "تحقق الآن" }
        };
        let currentLang = 'en';

        function detectLang(el) {
            const isAr = /[\u0600-\u06FF]/.test(el.value);
            currentLang = isAr ? 'ar' : 'en';
            document.body.classList.toggle('rtl', isAr);
            document.getElementById('lbl_title').innerText = strings[currentLang].title;
            document.getElementById('lbl_btn').innerText = strings[currentLang].btn;
        }

        async function checkNews() {
            const text = document.getElementById('newsText').value.trim();
            if(!text) return;

            const loader = document.getElementById('loading');
            const btn = document.getElementById('verifyBtn');
            loader.style.display = 'block';
            btn.disabled = true;

            try {
                const res = await fetch('/analyze', {
                    method:'POST',
                    headers:{'Content-Type':'application/json'},
                    body: JSON.stringify({ text: text, lang: currentLang })
                });
                const data = await res.json();

                loader.style.display = 'none';
                btn.disabled = false;

                const card = document.getElementById('resultCard');
                card.classList.remove('hidden');

                document.getElementById('actualDate').innerText = data.date_info || '';
                document.getElementById('verdictTitle').innerText = data.verdict;
                document.getElementById('scoreBadge').innerText = `${data.score}%`;
                document.getElementById('scoreBar').style.width = data.score + "%";

                const iconContainer = document.getElementById('resIconContainer');
                if(data.score >= 80){
                    document.getElementById('snd_real').play();
                    iconContainer.innerHTML = '<i class="fas fa-check-circle text-green-500"></i>';
                } else if(data.score <= 35){
                    document.getElementById('snd_fake').play();
                    iconContainer.innerHTML = '<i class="fas fa-times-circle text-red-500"></i>';
                } else {
                    iconContainer.innerHTML = '<i class="fas fa-exclamation-triangle text-yellow-500"></i>';
                }

            } catch(e){
                console.error(e);
                loader.style.display = 'none';
                btn.disabled = false;
                alert("Connection Error");
            }
        }
    </script>
</body>
</html>





